<!DOCTYPE html>
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <link rel="shortcut icon" href="favicon.ico">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" href="css/jquery.mobile-1.3.2.min.css"/>
        <link rel="stylesheet" href="css/jquery.mobile.structure-1.3.2.min.css" />
        <link rel="stylesheet" href="css/jquery.mobile.theme-1.3.2.min.css" />
        <link rel="stylesheet" href="css/royal.css" />
        <script src="js/jquery-1.10.2.min.js"></script>
        <script src="js/jquery.mobile-1.3.2.min.js"></script>
        <title>Club Royal</title>
    </head>
    <body>
        <section data-role="page" data-title="categoria" data-theme="b" id="productoInfo" data-add-back-btn="true" class="ui-responsive-panel" style="background-image: url(img/bg_noise.png)!important;background: url(img/bg_noise.png)!important;">
            <div data-role="header" data-theme="a" id="header">
                <a href="#" id="back" data-rel="back" data-icon="back" >Atr&aacute;s</a>
                <div style="visibility: hidden" id="redirect"></div>
                <h1>Productos</h1>
                <img align="right" id="logohead" src="img/logohead.png" onclick="goHome()" >
                <div data-role="navbar" data-iconpos="left" data-theme="c" class="barracat">
                    <ul>
                        <li style="width:40%;overflow:hidden"><a data-icon="grid" href="#nav-panel" id="categnom1" >Categor&iacute;as</a></li>
                        <li style="width:60%"><a href="#" id="categoryname" style="cursor:default;overflow:hidden">Producto</a></li>                        
                    </ul>
                </div>
            </div>
            <section data-role="content">
                <div style="">
                    <a class="" href="">
                        <span class="mini" id="disponibles"></span>
                        <span class="mini-bag item-count"><img src="img/joya.png" width="40" ></span>
                    </a>
                </div>

                <br/>
                <br/> 
                <hr><h1 id="productName"></h1>
                <div class="my-breakpoint" id="producto">
                    <div class="ui-body ui-body-d">  <center> <div id="image"></div></center></div>
                    <div class="ui-body ui-body-d">
                        <div id="valor" style="background-color: rgb(238, 238, 238)">                                 
                            <span id="vali" style="color: #006699;font-size: 1em;font-weight: bold;float: left;margin-right: 10px;">Valor:</span>  
                            <div id="222"> <span class="mini-bag item-count edgarMini" style="float: left !important"><img id="joyadesc" style="width: 52px;" src="img/joya.png"  ></span>
                                <span class="mini edgarPrecio" id="precio" style="float:left;"></span></div>
                            <div style="clear: both"></div>
                        </div>
                        <div data-role="collapsible-set">
                            <div data-role="collapsible" data-collapsed="true">
                                <h3>Descripción</h3>
                                <h2 id="sku"></h2>
                                <p id="descripcion"></p>
                                <div id="leyen">En caso que se agote la existencia de alguno de los productos, ser&aacute; sustituido por otro con caracter&iacute;sticas y valor similar.</div>                                     
                            </div>
                        </div>
                        <div data-mini="true" data-type="horizontal" data-role="controlgroup" class="ui-corner-all ui-controlgroup ui-controlgroup-horizontal ui-mini" aria-disabled="false" data-disabled="false" data-shadow="false" data-corners="true" data-exclude-invisible="true" data-init-selector=":jqmData(role='controlgroup')">
                            <div class="ui-controlgroup-controls">
                                <p style="margin: 0px;"><label class="quantity_box" for="quantity313">Cantidad:&nbsp;</label>
                                    <input type="text" value="1" name="quantity[]" id="quantity313" size="4" class="inputboxquantity"></p>   
                                <a data-theme="b" data-icon="plus" data-role="button" href="#" onclick="var qty_el = document.getElementById('quantity313');
                                        var qty = qty_el.value;
                                        if (!isNaN(qty))
                                            qty_el.value++;
                                        return false;" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-icon-left ui-first-child ui-btn-up-b"><span class="ui-btn-inner"><span class="ui-btn-text añadir">A&ntilde;adir</span><span class="ui-icon ui-icon-plus ui-icon-shadow">&nbsp;</span></span></a>
                                <a data-theme="b" data-icon="delete" data-role="button" href="#" onclick="var qty_el = document.getElementById('quantity313');
                                        var qty = qty_el.value;
                                        if (!isNaN(qty) && qty > 1)
                                            qty_el.value--;
                                        return false;" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-icon-left ui-btn-up-b"><span class="ui-btn-inner"><span class="ui-btn-text añadir">Eliminar</span><span class="ui-icon ui-icon-delete ui-icon-shadow">&nbsp;</span></span></a>
                            </div></div>
                        <!--                            <div data-role="button" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-theme="c" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-up-c" id="confirmar"><span class="ui-btn-inner"><span class="ui-btn-text">Confirmar</span></span></div>-->
                        <div data-theme="b" data-role="button"  id="confirmar1">Confirmar</div>
                    </div>
                </div>
            </section>
            <footer data-role="footer" data-position="fixed"  class="ui-fixed-hidden" >
                <div data-role="navbar" id="menubajo">
                    <ul>
                        <li><a data-icon="grid" href="home.html"  data-iconpos="top">Menú principal</a></li>
                        <li><a data-icon="star" href="carrito.html" data-iconpos="top">Carrito de compras</a></li>

                    </ul>
                </div>
                <div id="fot">
                    <img id="logofot1" src="img/adventa.png">     <img id="logofot2" src="img/adbox.png">   
                    <p>D.R.<abbr lang="en" title="Copyright"> &COPY;</abbr>Copyright 2013.  Derechos Reservados.  
                        T&eacute;rminos y condiciones de uso.  Aviso de Privacidad.</p></div>
            </footer>
            <div data-role="panel" data-position-fixed="true" data-theme="a" id="nav-panel">
                <ul data-role="listview" data-theme="a" class="nav-search" id="panelCategoria">
                </ul>
            </div> 
            <script type="text/javascript" src="js/BdLocal.js"></script>
            <script type="text/javascript" src="js/sesion.js"></script>
            <script type="text/javascript">
                                    var disponibles = 0;
                                    var idproducto = 0;
                                    $(document).bind("pageinit", function() {
                                        $.mobile.defaultPageTransition = "none";
                                    });
                                    $("#productoInfo").bind("pageshow", function() {
                                        idproducto = getUrlVars()["id"];
                                        disponibles = sesion.get('puntos').disponibles;
                                        $("#disponibles").text(disponibles);
                                        getProductoInfo(idproducto);
                                        getPanelCategorias();

                                    });
                                    $('#confirmar1').click(function() {
                                        var cantidad = $('#quantity313').val();
                                        var precio = $('#precio').text();
                                        var subtotal = precio * cantidad;
                                        if (disponibles !== undefined) {
                                            if (disponibles >= subtotal && subtotal !== 0) {
                                                addCart(idproducto, cantidad);
                                            } else {
                                                alert("Puntos insuficientes");
                                            }
                                            $.mobile.changePage("carrito.html", {});
                                        } else {
                                            alert("Sesión expirada\n\nPor favor vuelve a iniciar sesión");
                                            window.location = 'main.html';
                                        }
                                    });
                                    var getUrlVars = function() {
                                        var vars = {};
                                        var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m, key, value) {
                                            vars[key] = value;
                                        });
                                        return vars;
                                    };
            </script>
        </section>
    </body>
</html>
